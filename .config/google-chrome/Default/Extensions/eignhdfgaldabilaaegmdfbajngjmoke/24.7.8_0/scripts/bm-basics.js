"use strict";var bmBasics=function(){var s,o,n,r,t,a,i,c,u,l,f,p;function g(s){a=[],i=[],Object.keys(c).forEach(function(e){var t=-1!==s.indexOf(e),r=c[e].hidden;(!r||t&&"unused"===r||u&&"permanent"!==r)&&(t?a:i).push(e)}),a=a.sort(function(e,t){return s.indexOf(e)<s.indexOf(t)?-1:1}),i=i.sort(function(e,t){return c[e].label<c[t].label?-1:1})}function d(){browserStorage.sync.setItem("bm_pref__portal__services",a),t.forEach(function(e){e(a,i)})}function m(e){l.then(function(){e(a,i)})}return{userServices:(t=[],a=[],i=[],u=!(c={}),l=new Promise(function(e){r=e}),f=["aboutme","gplus","youtube","ytstudio","mybusiness","adwordsexpress","photos","albumarchive","myaccount","contacts","save","poly","play"],p={webmastertools:"searchconsole",tiltbrushsketches:"poly",vrblocks:"poly",playmusic:"music",chromeapps:"browserapps",chromebookmarks:"browserbookmarks",chrometopsites:"browsertopsites",gmaillite:"gmail",appmaker:"script",calendarlite:"calendar",publicalerts:"covid19",keeplite:"keep","keep-pro":"keep",googlepay:"gpay",payments:"gpay",adwords:"ads",music:"ytmusic",shortlists:"save",express:"shopping",gplus:"currents",flightsandhotels:"googletravel",flightshotels:"googletravel",packages:"googletravel",vacations:"googletravel",destinations:"googletravel",trips:"googletravel",travelpackages:"googletravel",trackedflightprices:"flights"},{getLastUsed:function(){return l.then(function(){return 0<a.length?{serviceId:n}:{serviceId:"customize",sessionParameters:{welcome:!0}}})},get:m,set:function(e){g(e),d()},contains:function(e){return-1!==a.indexOf(e)},add:function(e){g(a.concat(e)),d()},remove:function(e){var t=[].concat(e);-1!==t.indexOf("covid19")&&browserStorage.sync.setItem("bm_pref__portal__publicalertcorona",!0),g(a.filter(function(e){return-1===t.indexOf(e)})),d()},onChange:function(e){t.push(e),m(e)},init:function(e){s=e.defaultServices||[],u=e.debug||!1,c=e.servicesDatabase||{};var t=browserStorage.sync.get(["bm_pref__portal__services"]).then(function(e){return e.bm_pref__portal__services}),e=[browserStorage.local.getItem("bm_pref__portal__lastused"),t,e.servicesDatabaseRequest,e.accountRequest],e=Promise.all(e).then(function(e){var t=p[e[0]]||e[0],r=e[1]||s;if(c=e[2],o=e[3],n=t||r[0],!u&&o.pageId)return-1===(a=Object.keys(c).filter(function(e){return c[e].brandAccount&&!c[e].hidden}).sort(function(e,t){return f.indexOf(e)-f.indexOf(t)})).indexOf(n)&&(n="aboutme"),null;if(!Array.isArray(r))return n=t||s[0],void g(s);t=r.join(" ");Object.keys(p).forEach(function(e){var t=r.indexOf(e);-1!==t&&(r[t]=p[e])}),g(r),t!==a.join(" ")&&browserStorage.sync.setItem("bm_pref__portal__services",a)});r(e)}})}}();