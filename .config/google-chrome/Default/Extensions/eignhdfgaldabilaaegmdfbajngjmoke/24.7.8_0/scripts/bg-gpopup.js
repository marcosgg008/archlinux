"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bmCreateNewPopup(u){var f="undefined"!=typeof globalThis&&globalThis||window,c="object"===("undefined"==typeof chrome?"undefined":_typeof(chrome))&&chrome&&chrome.runtime&&chrome||"object"===("undefined"==typeof browser?"undefined":_typeof(browser))&&browser||{},p=c.webRequest;c.windows.create({type:"popup",width:600,height:600,top:u.topPosition||64,left:u.leftPosition||3e3,url:u.requestUrl},function(e){var t=e.tabs[0].id,o=e.id;function n(){c.tabs.onRemoved.removeListener(i),c.runtime.onMessage.removeListener(r),"object"===_typeof(p)&&p.onBeforeRequest.removeListener(s)}function r(e){e.closeAuthPopup&&(c.windows.remove(o),n())}function i(e){e===t&&n()}function s(e){if(!cjBasics.navigator.firefox){var o=new URL(e.url),e=o.hash||"#";"signin"===u.method?e="#signin":"signout"===u.method&&(e="#signout"),cjBasics.navigator.mac&&(e+="--macpopup");e=f.location.origin+"/views/cjg-popup.html"+o.search+e;return c.tabs.update(t,{url:e}),{redirectUrl:e}}}c.runtime.onMessage.addListener(r),c.tabs.onRemoved.addListener(i),"object"===_typeof(p)&&p.onBeforeRequest.addListener(s,{tabId:t,urls:[u.redirectUrl],types:["main_frame"]},["blocking"])})}