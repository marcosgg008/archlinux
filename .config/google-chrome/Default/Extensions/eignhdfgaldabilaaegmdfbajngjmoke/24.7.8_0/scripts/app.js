"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var o,t,a,r,i,s,c="object"===("undefined"==typeof chrome?"undefined":_typeof(chrome))&&chrome&&chrome.runtime&&chrome||"object"===("undefined"==typeof browser?"undefined":_typeof(browser))&&browser||{},e=new URLSearchParams(window.location.search.slice(1)),n=document.documentElement,l=!1,d=!1,u=e.get("page"),p=e.get("environment"),g="1"===e.get("debug"),m=!1;function f(n,o){var r;n&&(o=o||{},r=!1,c.tabs.query({currentWindow:!0},function(e){for(var a=n.replace("/u/0/","/"),s=e.length;0<s;s--){var t=e[s-1],i=t.pendingUrl||t.url;if("string"==typeof i&&(i.replace("/u/0/","/")===a||i.replace("/u/0/","/").split("?")[0].split("#")[0]===a)){c.tabs.update(t.id,{active:!0}),r=!0;break}}r||("newtab"===p?c.tabs.update({active:!0,url:n}):c.tabs.create({url:n})),"popup"!==p||o.noClose||window.close()}))}var b,y,v,h,w,j=(v=u||"search",h={customize:!(b=!(y=[])),accountchooser:!0,removedialog:!0,portal:!0,newtab:!0,pagestateupdate:!0,missingpermissions:!0,contentblocking:!0},{navigate:P,lock:function(e){P(e),b=!0},onChange:function(e){y.push(e),e(v)}});function P(e,a){var s,t,i;function n(){e===v&&s.onPageDisplayHandler(a||{})}b||((s=r[e])&&s.linkOnly?P(s.pageId,s.pageParameters||a):(s&&!s.loaded&&(s.loaded=!0,B(e)),t=v=e,i=o.querySelector(":scope > .selected"),t!==(i&&i.dataset.id||null)&&(t=o.querySelector(':scope > [data-id="'+t+'"]'),i&&i.classList.remove("selected"),t&&t.classList.add("selected")),y.forEach(function(e){e(v)}),h[v]||u||browserStorage.local.setItem("bm_pref__portal__lastused",v),s&&(s.onPageDisplayHandler?n():s.lastPageDisplayCallback=n)))}function S(e){var a=(e=e||{}).serviceData||{},s=cjgApis.session.account;return{missingGooglePermission:m,debugMode:g,instanceParameters:e.instanceParameters||{},darkMode:a.preferDarkMode?!l:d,setOnPageDisplayHandler:e.setOnPageDisplayHandler,account:s,wizPath:cjgApis.session.wizPath,openTab:f,requirePage:k,loadPage:B,environment:p,standaloneService:u,pageManager:j,userServices:bmBasics.userServices,servicesDatabase:r,ogbFeatures:{onNewTab:!0,portal:cjBasics.navigator.firefoxMobile,notifications:u&&a.showNotifications&&s.validSession,accountchooser:u&&s.validSession,signin:u&&!s.validSession}}}function k(e){var a,s,t,i=r[e]||{},n=i.loadPromise;return n||(a="/pages/"+e+"/index.js",s=[],t=i.preload||[],i.pageId?t.push(i.pageId):s.push(cjBasics.resources.loadScript(a)),i.extraCss&&s.push(cjBasics.resources.loadStyle("/pages/"+e+"/index.css")),Array.isArray(t)&&window.requestIdleCallback&&window.requestIdleCallback(function(){t.forEach(k)},{timeout:2e3}),Array.isArray(i.dependencies)&&i.dependencies.forEach(function(e){s.push(k(e))}),n=Promise.all(s),i.loadPromise=n),n}function B(e){var a=r[e],s=a.pageId||e,t=a.pageParameters,i=!cjBasics.wrif.supported&&a.wrifFallbackPageId;i&&(r[i]?s=i:(s="pagestateupdate",t={productId:e}));var n=cjBasics.navigator.firefox&&a.firefoxFallbackPageId,i=r[s=n?n:s],n=cjgApis.session.account;m&&!i.noGooglePermissionNeeded?(s="pagestateupdate",t={productId:e,missingPermissions:!0}):cjgApis.session.hasContentBlocking&&("valid"===i.requireSignin||cjBasics.navigator.firefox&&i.requireSigninFirefox)?(s="pagestateupdate",t={productId:e,contentBlocking:!0}):!n.validSession&&(i.requireSignin||cjBasics.navigator.firefox&&i.requireSigninFirefox)?(s="pagestateupdate",t={productId:e,signinRequired:!0}):!n.pageId||a.brandAccount&&i.brandAccount||(s="pagestateupdate",t={productId:e,brandAccountUnsupported:!0});t=S({serviceData:a,setOnPageDisplayHandler:function(e){a.onPageDisplayHandler=e,setTimeout(function(){"function"==typeof a.lastPageDisplayCallback&&a.lastPageDisplayCallback(),a.lastPageDisplayCallback=null})},instanceParameters:t}),t=cjce.createElement("bm-app",{pageId:s,bmApis:t});t.dataset.id=e,o.appendChild(t)}function _(a){return new Promise(function(e){c.permissions.contains({origins:[a]},e)})}function I(){document.body.textContent="",a=browserStorage.sync.getItem("bm_pref__main__language").then(function(e){return cjBasics.lang.overwriteLanguage(e)}),i=cjBasics.ajax("/pages.json",{fetchAs:"json"}).then(function(s){return a.then(function(){return Object.keys(s).forEach(function(e){var a=s[e].labelI18n;a&&(s[e].label=cjBasics.lang.i18n(a,s[e].label))}),cjBasics.geo.isUsaCheck()&&(s.movies.color=!0,s.movies.iconName="tv",s.movies.label=cjBasics.lang.i18n("cj_i18n_06402","Google TV")),r=s})}),s=cjBasics.wrif.restoreSupported(),t=browserStorage.sync.getItem("bm_pref__main__theme").then(function(e){"classic"!==e&&("light"!==e?"dark"!==e&&!matchMedia("(prefers-color-scheme: dark)").matches||(d=!0,n.classList.add("bm-style-flag--dark")):l=!0)});var e=["search","maps","translate","news","youtube","gmail","calendar","drive","keep","tasks","shopping"];"newtab"===p&&(document.title="New Tab for Googleâ„¢",e=["chromtopsites","chromebookmarks","calendar","keep","news","drive","gmail","tasks","maps","contacts"]),bmBasics.userServices.init({debug:g,defaultServices:e,accountRequest:cjgApis.session.ready,servicesDatabaseRequest:i}),c.runtime.onMessage.addListener(function(e){e.reloadAllInstances&&window.location.reload()});e=!u&&"sidebar"!==p&&!cjBasics.navigator.firefoxMobile;e&&function(){var a=document.createElement("div");a.className="bm-ele-mainportal";var s="portal";"newtab"===p?(s="newtab",a.classList.add("bm-ele-mainportal--newtab")):a.classList.add("bm-ele-mainportal--sideportal"),document.body.appendChild(a),Promise.all([i,t,cjgApis.session.ready]).then(function(){var e=r[s],e=cjce.createElement("bm-app",{pageId:s,bmApis:S({serviceData:e})});a.appendChild(e)})}(),e=e,(o=document.createElement("div")).className="bm-ele-mainwindow","newtab"===p?o.classList.add("bm-ele-mainwindow--newtab"):e&&o.classList.add("bm-ele-mainwindow--sideportal"),document.body.appendChild(o),setTimeout(function(){cjBasics.resources.loadStyle("/styles/app-delayed.css").then(function(){n.classList.add("bm-style-flag--loaded")})},10);e=("object"!==_typeof(c.permissions)?Promise.resolve(!0):Promise.all([_("https://*.google.com/*"),_("https://*.google.com/cjg-apis/*")]).then(function(e){return e[0]||e[1]})).then(function(e){m=!e}),e=[i,t,s,cjgApis.session.ready,cjBasics.webRequest.getTabId(),e];Promise.all(e).then(function(){u?j.navigate(u):bmBasics.userServices.getLastUsed().then(function(e){j.navigate(e.serviceId)})},function(e){})}u&&"sidebar"!==p&&n.classList.add("bm-style-flag--singlepage"),cjBasics.navigator.firefox&&(n.classList.add("bm-style-flag--firefox"),"options"===p&&n.classList.add("bm-style-flag--firefox-options")),"popup"===p&&(n.classList.add("bm-style=flag--ext-popup"),cjBasics.navigator.mac&&c.runtime.sendMessage({closeAuthPopup:!0}),(cjBasics.navigator.mac||cjBasics.navigator.firefox)&&(w=1600,function e(){n.classList.add("bm-style-flag--macfix"),setTimeout(function(){n.classList.remove("bm-style-flag--macfix")},20),0<w&&(setTimeout(e,500),w-=500)}())),"object"===_typeof(c.i18n)&&"function"==typeof c.i18n.getMessage&&(n.dir=c.i18n.getMessage("@@bidi_dir")||"ltr",n.lang=(c.i18n.getMessage("@@ui_locale")||"en").replace("_","-")),cjBasics.events.focusVisibleHandling(),"popup"===p?"complete"===document.readyState?setTimeout(I,100):window.addEventListener("load",function(){setTimeout(I,100)}):I()}();