"use strict";cjce.registerTemplate("bm-p-reminderswithgapi__reminderslist",function(n,e){var t,a,r=e.bmApis,i=e.onLoadChange,c="https://reminders-pa.googleapis.com",s="https://keep.google.com/"+r.wizPath,l=["https://www.googleapis.com/auth/reminders"],o=window.atob("QUl6YVN5QldkTkdkdEZBVk1ucktVaTA0YnRxcVhvVzNsNHNvMFVr");function d(){var e=cjgShortcuts.getUrl("540",r.account);r.openTab(e)}function u(){var e=cjce.createElement("bm-fulldialog",{bmApis:r,onNewTab:d,lockup:{label:cjBasics.lang.i18n("cj_i18n_00081","Reminders")},iconName:"reminders",message:cjBasics.lang.i18n("cj_i18n_00212","To use Reminders, you need to give access to load your Google Reminders data"),actionLabel:cjBasics.lang.i18n("cj_i18n_01916","Continue with Google"),actionG:!0,action:function(){cjgApis.auth.requestPermissions(r.account,l)}});n.appendChild(e)}function m(e,n){var t=!e.dueDate,a=!n.dueDate;if(t&&a)return e.title>n.title?1:-1;if(t)return 1;if(a)return-1;var i=!0===e.dueDate.unspecifiedFutureTime,c=!0===n.dueDate.unspecifiedFutureTime;if(i&&c)return e.title>n.title?1:-1;if(i)return 1;if(c)return-1;t=parseInt(e.dueDate.absoluteTimeMs,10),a=parseInt(n.dueDate.absoluteTimeMs,10),i=e.dueDate.allDay,c=n.dueDate.allDay;if(e.dueDate.day===n.dueDate.day){if(i&&c||t===a)return e.title>n.title?1:-1;if(i)return-1;if(c)return 1}return a<t?-1:1}function p(e){var n,t=(n=(n=(n=(a=e).extensions)&&n.keepExtension&&n.keepExtension)&&(n.serverNoteId||n.clientNoteId))?{url:s+"#NOTE/"+n,noteId:n}:(a=(a=a.externalApplicationLink)&&"keepReminder"===a.application&&a.id)?{url:s+"?reminder="+a,reminderId:a}:void 0;if(t)return{label:cjBasics.lang.i18n("cj_i18n_00215","View note"),onClick:function(e){e&&(cjBasics.events.hasMeta(e)||e.shiftKey)?r.openTab(t.url):r.pageManager.navigate("keep",{noteData:t})}};var a=e.assistance&&e.assistance.taskAssistance&&e.assistance.taskAssistance.assistance&&e.assistance.taskAssistance.assistance[0];if(!a)return null;if(a.callAction){e=a.callAction.phoneNumber;if(!e)return null;var i=e[0]&&e[0].phoneNumber;return i?{label:cjBasics.lang.i18n("cj_i18n_00213","Call"),onClick:function(){var e=cjBasics.urlParams.attach("https://hangouts.google.com/",{authuser:r.account.authuser,action:"chat",pn:i});r.openTab(e)}}:null}if(a.emailAction){var c=a.emailAction.emailAddress&&a.emailAction.emailAddress[0]&&a.emailAction.emailAddress[0].emailAddress;return{label:cjBasics.lang.i18n("cj_i18n_00214","Email"),onClick:function(){r.openTab("mailto:"+c)}}}return null}function g(e){var n=cjce.createElement("cjmd-card",{withPadding:!0}),t=cjce.createElement("cjmd-title",{label:e.title||cjBasics.lang.i18n("cj_i18n_01737","(No title)")});n.appendChild(t),e.dueDate&&((t=document.createElement("div")).className="cjmd-secondarytext",t.textContent=function(e){if(e.unspecifiedFutureTime)return"Someday";var n=new Date;return n.setFullYear(e.year),n.setMonth(e.month-1),n.setDate(e.day),e.time&&(n.setHours(e.time.hour),n.setMinutes(e.time.minute),n.setSeconds(e.time.second)),cjBasics.datetime.printDateString(n.getTime(),{time:!e.allDay,weekday:!0})}(e.dueDate),n.appendChild(t));e=p(e);return e&&((e=cjce.createElement("cjmd-button",{color:!0,hairline:!0,label:e.label,onClick:e.onClick})).style.marginTop="8px",n.appendChild(e)),n}function h(e){n.textContent="",Array.isArray(e)&&0<e.length?e.forEach(function(e){e=g(e);n.appendChild(e)}):(e=cjce.createElement("cjmd-emptystate",{label:cjBasics.lang.i18n("cj_i18n_01499","No reminders found"),iconName:"__mdi:reminder"}),n.appendChild(e))}cjce.applyTemplate(n,"cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"}),cjgApis.cache.getItem(r.account,"bm_cache_v31__reminderswithgapi__reminders").then(function(e){Array.isArray(e)&&(t=JSON.stringify(e),h(e))}),a=cjBasics.urlParams.attach(c+"/v1internalOP/reminders/list",{fields:"task",prettyPrint:"false"}),cjgApis.request(a,{method:"POST",fetchAs:"json",headers:{"Content-Type":"application/json"},body:JSON.stringify({includeDeleted:!1,includeArchived:!1})},{pa:!0,key:o,account:r.account,requiredScopes:l}).then(function(e){e=e.task.sort(m);return cjgApis.cache.setItem(r.account,"bm_cache_v31__reminderswithgapi__reminders",e),e},u).then(function(e){return Array.isArray(e)?e:[]},function(){return[]}).then(function(e){t&&JSON.stringify(e)===t||(h(e),i&&i(!1))})}),cjce.registerTemplate("bm-p-reminderswithgapi",function(e,t){var n=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,serviceIcon:"reminders",serviceLabel:cjBasics.lang.i18n("cj_i18n_00081","Reminders"),pageLabel:cjBasics.lang.i18n("cj_i18n_00291","Home"),bmApis:t,onNewTab:function(){var e=cjgShortcuts.getUrl("540",t.account);t.openTab(e)}});e.appendChild(n);var a={reminders:{iconName:"__mdi:home",label:cjBasics.lang.i18n("cj_i18n_00291","Home"),shortcutId:"561"},relatedHeader:{header:!0,color:!0,label:cjBasics.lang.i18n("cj_i18n_01539","Related apps")},calendar:{iconName:"__mdi:event",label:cjBasics.lang.i18n("cj_i18n_00302","Calendar"),shortcutId:"27"},keep:{iconName:"__mdi:drive_keep",label:cjBasics.lang.i18n("cj_i18n_00422","Keep"),shortcutId:"97"},tasks:{iconName:"__mdi:tasks",label:cjBasics.lang.i18n("cj_i18n_00439","Tasks"),shortcutId:"140"}},a=cjce.createElement("bm-navlist",{selectedId:"reminders",items:a,onClick:function(e){t.pageManager.navigate(e)},onNewTab:function(e,n){n=n.newTabUrl||cjgShortcuts.getUrl(n.shortcutId,t.account);t.openTab(n)}});n.cjceDrawerEl.appendChild(a);a=cjce.createElement("bm-p-reminderswithgapi__reminderslist",{bmApis:t,onLoadChange:function(e){n.cjceSetLoading(e)}});e.appendChild(a)});