"use strict";cjce.registerTemplate("bm-p-sites",function(t,o){var a,c,i,r="my",l=window.location.origin,d="https://sites.google.com",n=d+"/site/sites/system/app/pages/meta/",s={my:{label:cjBasics.lang.i18n("cj_i18n_00054","My sites"),iconName:"__mdi:drive_site",shortcutId:"130"},trash:{label:cjBasics.lang.i18n("cj_i18n_00113","Deleted sites"),iconName:"__mdi:delete",newTabUrl:n+"dashboard/deleted?authuser="+o.account.authuser,divider:!0},atari:{label:cjBasics.lang.i18n("cj_i18n_00112","Sites"),iconName:"__mdi:atari_site",color:"#3f51b5",colorIcon:!0,shortcutId:"504"}};function u(e){e=cjBasics.urlParams.attach(n+"search",{scope:"my",q:e,authuser:o.account.authuser});o.openTab(e)}function m(){var n=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:"my",items:s,onChange:function(e,t){if("atari"===e)return o.pageManager.navigate("atari"),void(n.cjceSelectedId=r);var a;e=s[r=a=e].label,i.cjceSetPageLabel(e),h(a)},onNewTab:function(e,t){t=t.newTabUrl||cjgShortcuts.getUrl(t.shortcutId,o.account);o.openTab(t)}});c.appendChild(n)}function h(e){a.textContent="";var n=cjce.createElement("cjmd-container",{scrollable:!0,fabPadding:!0,shadow:"thinOnScroll"});cjce.applyTemplate(n,"bm-loading",{state:!0}),a.appendChild(n);var c="trash"===e,e=c?p("dashboard/deleted").then(function(e){if(-1===e.indexOf('<ul id="sites-dashboard-list-mobile">'))return[];var e=e.replace(/onclick/g,"data-click").split('<ul id="sites-dashboard-list-mobile">')[1].split("</ul>")[0],t=(new window.DOMParser).parseFromString(e,"text/html").body.children;if(0===t.length||!t[0]||!t[0].querySelector(".sites-dashboard-list-mobile-name"))return[];for(var a=[],n=0;n<t.length;n++){var c=t[n],i=c.querySelector("a").dataset.click.split("'")[1].split("'")[0],r=c.querySelector(".sites-dashboard-list-mobile-name").textContent,l=d+"/site/"+i+"?authuser="+o.account.authuser,s=c.querySelector("div:nth-child(2)").textContent.split(":")[1],c=c.querySelector("div:nth-child(3)").textContent.split(":")[1];a.push({url:l,primaryText:r,secondaryText:"Deleted by"+s+" on"+c,tertiaryText:"/site/"+i})}return a}):p("dashboard").then(function(e){if(-1===e.indexOf("<ul>"))return[];var e=e.split("<ul>")[1].split("</ul>")[0],t=(new window.DOMParser).parseFromString(e,"text/html").body.children;if(0===t.length||!t[0]||!t[0].querySelector(".your-site-title"))return[];for(var a=[],n=0;n<t.length;n++){var c=t[n],i={url:d+c.querySelector(".your-site-title").href.replace(l,"")+"?authuser="+o.account.authuser,primaryText:c.querySelector(".your-site-title").textContent,secondaryText:c.querySelector(".sites-dash-site-url").textContent};c.querySelector(".wiki_summarized")&&(i.tertiaryText=c.querySelector(".wiki_summarized").textContent),a.push(i)}return a});e.then(function(e){var t,a;0===e.length?(a=c,a=cjce.createElement("cjmd-emptystate",{label:cjBasics.lang.i18n("cj_i18n_00055","No sites found"),subLabel:a?null:cjBasics.lang.i18n("cj_i18n_00114","To add a new site, click the add button"),iconName:"__mdi:drive_site"}),n.appendChild(a)):(t=cjce.createElement("cjmd-list"),e.forEach(function(e){e=function(e){var t=cjce.createElement("cjmd-item",{multiline:!0});t.addEventListener("click",function(){o.openTab(e.url)});var a=cjce.createElement("cjmd-icon",{favicon:e.url});t.appendChild(a);var n=document.createElement("div");return n.className="cjmd-item__body",t.appendChild(n),(a=document.createElement("div")).className="cjmd-item__header",a.textContent=e.primaryText,n.appendChild(a),(a=document.createElement("div")).className="cjmd-secondarytext",a.textContent=e.secondaryText,n.appendChild(a),e.tertiaryText&&((a=document.createElement("div")).className="cjmd-secondarytext",a.textContent=e.tertiaryText,n.appendChild(a)),t}(e);t.appendChild(e)}),n.appendChild(t)),cjce.applyTemplate(n,"bm-loading",{state:!1})})}function p(e){e=cjBasics.urlParams.attach(n+e,{mobile:"true",hl:"en",authuser:o.account.authuser});return cjBasics.ajax(e)}!function(){i=cjce.createElement("bm-ogb",{drawer:!0,serviceIcon:"jotspot",serviceLabel:cjBasics.lang.i18n("cj_i18n_00111","Classic Sites"),pageLabel:cjBasics.lang.i18n("cj_i18n_00054","My sites"),searchbox:{onSubmit:u,submitInNewTab:!0},bmApis:o,onNewTab:function(){var e=s[r].newTabUrl;o.openTab(e)}}),t.appendChild(i),c=i.cjceDrawerEl,m(),o.setOnPageDisplayHandler(i.cjceSearchboxEl.select);var e=cjce.createElement("cjmd-fabgroup",{items:[cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_00115","Create new site"),onClick:function(){var e=n+"dashboard/create-new-site?authuser="+o.account.authuser;o.openTab(e)}}),cjce.createElement("cjmd-fab",{mini:!0,color:"#3f51b5",iconName:"__mdi:atari_site",label:cjBasics.lang.i18n("cj_i18n_00115","Create new site"),onClick:function(){var e=d+"/create?authuser="+o.account.authuser;o.openTab(e)}})]});t.appendChild(e),a=cjce.createElement("cjmd-container"),t.appendChild(a),h(r)}()});