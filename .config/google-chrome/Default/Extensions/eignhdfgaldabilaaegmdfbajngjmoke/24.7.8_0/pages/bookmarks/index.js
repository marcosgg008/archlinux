"use strict";cjce.registerTemplate("bm-p-bookmarks",function(m,_){var h,o,t,i,r,s,k=cjBasics.lang.i18n("cj_i18n_01250","All items"),p="https://www.google.com/bookmarks/",g="0"===_.account.authuser?null:_.account.authuser,f=cjBasics.urlParams.attach(p,{authuser:g}),d="_bm_all";function n(e){e=cjBasics.urlParams.attach(p+"find",{q:e,authuser:g});_.openTab(e)}function b(e,a){a=a||{};a.sig=h;e=cjBasics.urlParams.attach(p+(e||""),{authuser:g});return cjBasics.ajax(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"},body:cjBasics.urlParams.create(a)})}function j(e,a){return a&&(e+=","+a),b("mark",{op:"modlabel",labels:e})}function u(a,c){var e=c.customLabel?{renameLabel:{iconName:"__mdi:cjg_rename",label:cjBasics.lang.i18n("cj_i18n_01940","Rename")},deleteLabel:{iconName:"__mdi:delete",label:cjBasics.lang.i18n("cj_i18n_01563","Delete")}}:{copyBookmark:{iconName:"__mdi:link",label:cjBasics.lang.i18n("cj_i18n_01901","Copy link")},editBookmark:{iconName:"__mdi:edit",label:cjBasics.lang.i18n("cj_i18n_05629","Edit")},deleteBookmark:{iconName:"__mdi:delete",label:cjBasics.lang.i18n("cj_i18n_01563","Delete")}},e=cjce.createElement("cjmd-iconbuttonmenu",{label:cjBasics.lang.i18n("cj_i18n_06294","More actions"),items:e,onClick:function(e){"copyBookmark"===e?cjBasics.clipboard.copy(c.url):"deleteBookmark"===e?b("mark",{dlq:c.id}).then(function(){a.remove()}):"editBookmark"===e?C({bkmk:c.url,title:c.title},!0):"deleteLabel"===e?j(c.label).then(function(){a.remove(),B()}):"renameLabel"===e&&function(e){var a=cjce.createElement("cjmd-textfield",{label:cjBasics.lang.i18n("cj_i18n_06314","Label name")}),c=cjBasics.lang.i18n("cj_i18n_01737","(No title)"),n=e.label||c;a.cjceValue=n;var l=cjce.createElement("cjmd-dialog",{title:cjBasics.lang.i18n("cj_i18n_06312","Rename bookmark label"),message:cjBasics.lang.i18n("cj_i18n_06313","Please enter a new label name"),confirmLabel:cjBasics.lang.i18n("cj_i18n_01940","Rename"),cancelLabel:cjBasics.lang.i18n("cj_i18n_01659","Cancel"),additionalFragment:a,onConfirm:function(){var e=a.cjceValue||c;j(n,e).then(B)}});document.body.appendChild(l),setTimeout(function(){l.showModal(),l=null,a.cjceSelect()})}(c)}});return e.classList.add("cjmd-item__hovertools"),e}function l(e){t.textContent="";var a,c,n,l=((e=e)[e.length-1].divider=!0,e.concat([{id:"_bm_settings",iconName:"__mdi:settings",newTabUrl:cjBasics.urlParams.attach(p+"mark",{op:"editl",authuser:g}),label:cjBasics.lang.i18n("cj_i18n_00010","Manage labels"),external:!0},{id:"_bm_export",iconName:"__mdi:file_download",newTabUrl:cjBasics.urlParams.attach(p+"bookmarks.html",{hl:cjBasics.lang.current,authuser:g}),label:cjBasics.lang.i18n("cj_i18n_01251","Export bookmarks"),external:!0},{id:"_bm_deleteall",iconName:"__mdi:delete",newTabUrl:cjBasics.urlParams.attach(p+"edit",{ceh:"1",authuser:g}),label:cjBasics.lang.i18n("cj_i18n_06315","Delete all bookmarks"),external:!0}]));for(a in d="_bm_all",i=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:d,items:l,onChange:function(e,a){d=e,r.cjceSetPageLabel(a.label);var c=!1;s.hidden=!0;for(var n=o.querySelectorAll(".cjmd-item"),l=0;l<n.length;l++){var t=n[l],i=-1===t.bookmarkLabels.indexOf(e);t.hidden=i,c||i||(c=!0)}c||(s.hidden=!1)},onNewTab:function(e,a){_.openTab(a.newTabUrl)}}),l)l[a].customLabel&&l[a].cjceDomEl&&(n=u((c=l[a]).cjceDomEl,c),c.cjceDomEl.appendChild(n));t.appendChild(i)}function v(e,a){var c,n=e.bookmarks;a||l(e.labels),o.textContent="",s=cjce.createElement("cjmd-emptystate",{color:!0,label:cjBasics.lang.i18n("cj_i18n_00370","No bookmarks found"),subLabel:cjBasics.lang.i18n("cj_i18n_00371","To add a bookmark, click the add button at the bottom"),iconName:"__mdi:star_outline"}),0<n.length&&(s.hidden=!0,c=cjce.createElement("cjmd-list"),n.forEach(function(e){e=function(a){var c=cjce.createElement("cjmd-item");c.addEventListener("click",function(e){e.target===c&&_.openTab(a.url)}),c.bookmarkLabels=a.labels;var e=cjce.createElement("cjmd-icon",{favicon:a.url});c.appendChild(e);var n=document.createElement("div");n.className="cjmd-item__body";var l=document.createElement("div");return l.className="cjmd-item__header",l.textContent=a.title,n.appendChild(l),(e=document.createElement("div")).className="cjmd-secondarytext",e.textContent=a.url,n.appendChild(e),(l=document.createElement("div")).className="cjmd-secondarytext",e=[],a.labelsText&&e.push(a.labelsText),l.textContent=e.join(" - "),n.appendChild(l),c.appendChild(n),n=u(c,a),c.appendChild(n),c}(e);c.appendChild(e)}),o.appendChild(c)),o.appendChild(s),a||r.cjceSetLoading(!1)}function B(){return r.cjceSetLoading(!0),e=cjBasics.urlParams.attach(p+"lookup",{start:"0",num:"1000000000",hl:cjBasics.lang.current,authuser:g}),cjBasics.ajax(e).then(function(e){h=(a=(a=e).match(/data-signature=["']([a-zA-Z0-9-_]{44})["']/)||a.match(/name="sig" value="([a-zA-Z0-9-_]{44})"/)||a.match(/sig=([a-zA-Z0-9-_]{44})["']/)||a.match(/sig\\x3d([a-zA-Z0-9-_]{44})["']/)||a.match(/value="([a-zA-Z0-9-_]{44})"/))?a[1]:null;var a='id="search">',a=-1===e.indexOf(a)?"":e.split(a)[1].split('<div style="text-align: center;"')[0],c=(new window.DOMParser).parseFromString(a,"text/html").querySelectorAll('div[id] > span[id*="bkmk_view_"]'),n={_bm_all:{iconName:"__mdi:home",label:k,newTabUrl:f}};function l(e){n[e]||e.startsWith("_bm_unlabeled")||(n[e]={customLabel:!0,iconName:"__mdi:label",label:e,newTabUrl:cjBasics.urlParams.attach(p+"lookup",{authuser:g,q:'label:"'+e+'"'})})}for(var t=[],i=0;i<c.length;i++){var o=c[i],r=o.querySelector('[id*="bkmk_info_"]'),s=r?r.textContent:"",m=["_bm_all"];if(r)for(var d=r.querySelectorAll("span > a"),b=0;b<d.length;b++)m.push(d[b].textContent);else m.push("_bm_unlabeled");m.forEach(l);var j=o.querySelector('[id*="bkmk_href_"]'),u=new URLSearchParams(j.search),r=o.querySelector("[data-bookmark-id]");t.push({id:r&&r.dataset.bookmarkId||null,url:u.get("q"),title:j.textContent,timestamp:parseInt(o.querySelector("script").textContent.split("_tsRender(")[1].split(",")[0],10),labels:m,labelsText:s})}a=Object.keys(n).map(function(e){var a=n[e];return a.id=e,a});a.push({id:"_bm_unlabeled",iconName:"__mdi:label_off",label:cjBasics.lang.i18n("cj_i18n_00369","Unlabeled"),newTabUrl:cjBasics.urlParams.attach(p+"lookup",{authuser:g,q:"label:^none"})});a={bookmarks:t,labels:a};return cjgApis.cache.setItem(_.account,"bm_cache_v31__bookmarks__bookmarks",a),a}).then(v);var e}function C(e,a){var c=cjce.createElement("cjmd-container",{solid:!0,floating:!0}),n=cjce.createElement("bm-ogb",{displayBack:!0,serviceIcon:"bookmarks",serviceLabel:cjBasics.lang.i18n("cj_i18n_00190","Bookmarks"),pageLabel:a?cjBasics.lang.i18n("cj_i18n_04577","Edit bookmark"):cjBasics.lang.i18n("cj_i18n_00009","Add bookmark"),onBack:function(){c.remove()},bmApis:_});c.appendChild(n);var l=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"});c.appendChild(l);var t=document.createElement("div");t.className="bm-p-bookmarks-form",l.appendChild(t);var i=cjce.createElement("cjmd-textfield",{floatingLabel:!0,label:cjBasics.lang.i18n("cj_i18n_06316","Name")});t.appendChild(i);var o=cjce.createElement("cjmd-textfield",{floatingLabel:!0,label:cjBasics.lang.i18n("cj_i18n_06317","Location (URL)")});a||t.appendChild(o);var r=cjce.createElement("cjmd-textfield",{floatingLabel:!0,label:cjBasics.lang.i18n("cj_i18n_06318","Labels")});t.appendChild(r);var s=cjce.createElement("cjmd-textfield",{floatingLabel:!0,label:cjBasics.lang.i18n("cj_i18n_06319","Notes"),multiline:!0});t.appendChild(s);t=cjce.createElement("cjmd-button",{label:cjBasics.lang.i18n("cj_i18n_01363","Save"),fill:!0,color:!0,onClick:function(){var e;b("mark",{title:(e={title:i.cjceValue,bkmk:o.cjceValue,labels:r.cjceValue,annotation:s.cjceValue}).title||cjBasics.lang.i18n("cj_i18n_01737","(No title)"),bkmk:e.bkmk,labels:e.labels||"",annotation:e.annotation||""}).then(function(){c.remove(),B()})}});n.cjceAppendChild(t);t=e&&e.title;t&&(i.cjceValue=t);e=e&&e.bkmk;e&&(o.cjceValue=e),m.appendChild(c),setTimeout(function(){i.cjceSelect()})}!function(){var a;r=cjce.createElement("bm-ogb",{loading:!0,serviceIcon:"bookmarks",serviceLabel:cjBasics.lang.i18n("cj_i18n_00190","Bookmarks"),pageLabel:k,searchbox:{onSubmit:n,submitInNewTab:!0},drawer:!0,bmApis:_,onNewTab:function(){var e=null,a=i&&i.cjceSelectedId;a&&"_bm_all"!==a&&(e="label:"+a),"_bm_unlabeled"===a&&(e="label:^none");e=cjBasics.urlParams.attach(p+"lookup",{authuser:g,q:e});_.openTab(e)}}),m.appendChild(r),_.setOnPageDisplayHandler(r.cjceSearchboxEl.select),t=r.cjceDrawerEl;var c=cjce.createElement("cjmd-fab",{mini:!0,color:!0,iconName:"__mdi:link",label:cjBasics.lang.i18n("cj_i18n_06295","Bookmark this"),onClick:function(){C({bkmk:a.url,title:a.title})}});cjBasics.navigator.getActionableUrl().then(function(e){e?(a=e,c.title=cjBasics.lang.i18n("cj_i18n_06295","Bookmark this")+" ("+a.url+")"):c.remove()});var e=cjce.createElement("cjmd-fabgroup",{items:[cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_00009","Add bookmark"),onClick:function(){C()}}),c]});m.appendChild(e),o=cjce.createElement("cjmd-container",{scrollable:!0,fabPadding:!0,shadow:"thinOnScroll"}),m.appendChild(o),cjgApis.cache.getItem(_.account,"bm_cache_v31__bookmarks__bookmarks").then(function(e){return e||{bookmarks:[],labels:[]}}).then(function(e){v(e,!0)}),B()}()});