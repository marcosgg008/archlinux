"use strict";cjce.registerTemplate("bm-p-drive",function(o,l){var r,t,s,e,i,c,d,n,m,p,_,u,f,g,v,h="my-drive",b=h,j=h,y=!1,a=(Math.round(document.documentElement.offsetHeight*document.documentElement.offsetWidth/7500),"https://drive.google.com"),T=a+"/drive/"+l.wizPath;function w(){var e=T+("folder"===h||"shareddrive"===h?"folders/"+_.id:"search"===h?"search?q="+encodeURIComponent(d.value):h);l.openTab(e)}var B,C=["trash","starred","my-drive","folder"],S=window.atob("QUl6YVN5RFA3MkZMTVpCNng0ejZDVnlCOG8wQUthWC0yRDdueGMw"),x="https://content.googleapis.com",U=x+"/drive/v3/",E=["https://www.googleapis.com/auth/drive"],N=["https://www.googleapis.com/auth/drive.apps.readonly"],L=!0,q=cjgApis.auth.requireToken(l.account,E).catch(function(e){return L=!1,e}),z={},k=["196802322321","230754619982","335078253515","619683526622","629453589428","796396377186","889782162350","897606708560","952342923413","371237729773","1083656409722"],P={name:cjBasics.lang.i18n("cj_i18n_01990","Name"),lastModified:cjBasics.lang.i18n("cj_i18n_00093","Last modified"),lastModifiedByMe:cjBasics.lang.i18n("cj_i18n_00094","Last modified by me"),lastOpenedByMe:cjBasics.lang.i18n("cj_i18n_00095","Last opened by me")},A={name:"name",lastModified:"modifiedTime desc",lastModifiedByMe:"modifiedByMeTime desc",lastOpenedByMe:"viewedByMeTime desc"},I={archive:"(mimeType = 'application/bzip2' or mimeType = 'application/gzip' or mimeType = 'application/gzip-compressed' or mimeType = 'application/gzipped' or mimeType = 'application/rar' or mimeType = 'application/tar' or mimeType = 'application/x-bzip' or mimeType = 'application/x-bzip-compressed-tar' or mimeType = 'application/x-bzip2' or mimeType = 'application/x-gtar' or mimeType = 'application/x-gtar-compressed' or mimeType = 'application/x-gunzip' or mimeType = 'application/x-gzip' or mimeType = 'application/x-gzip-compressed' or mimeType = 'application/x-rar' or mimeType = 'application/x-tar' or mimeType = 'application/x-tgz' or mimeType = 'application/x-zip' or mimeType = 'application/x-zip-compressed' or mimeType = 'application/zip' or mimeType = 'gzip/document' or mimeType = 'multipart/x-gzip' or mimeType = 'multipart/x-rar' or mimeType = 'multipart/x-tar' or mimeType = 'multipart/x-zip' or mimeType = 'multipart/zip')",audio:"(mimeType = 'audio/3gp' or mimeType = 'audio/midi' or mimeType = 'audio/mp4a-latm' or mimeType = 'audio/mpeg' or mimeType = 'audio/mpeg3' or mimeType = 'audio/ogg' or mimeType = 'audio/x-ms-wma' or mimeType = 'audio/x-wav' or mimeType = 'audio/wav')",document:"(mimeType = 'application/msword' or mimeType = 'application/vnd.google-apps.document' or mimeType = 'application/vnd.google-apps.kix' or mimeType = 'application/vnd.ms-word' or mimeType = 'application/vnd.oasis.opendocument.text' or mimeType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' or mimeType = 'text/plain')",drawing:"(mimeType = 'application/vnd.oasis.opendocument.graphics' or mimeType = 'image/vnd.adobe.photoshop' or mimeType = 'image/x-photoshop' or mimeType = 'application/illustrator' or mimeType = 'application/vnd.google-apps.drawing')",folder:"(mimeType = 'application/vnd.google-apps.folder')",form:"(mimeType = 'application/vnd.google-apps.form' or mimeType = 'application/vnd.google-apps.freebird')",image:"(mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'image/gif' or mimeType = 'image/tiff' or mimeType = 'image/x-ms-bmp' or mimeType = 'image/svg+xml' or mimeType = 'image/vnd.microsoft.icon')",pdf:"(mimeType = 'application/pdf')",presentation:"(mimeType = 'application/mspowerpoint' or mimeType = 'application/vnd.ms-powerpoint' or mimeType = 'application/vnd.oasis.opendocument.presentation' or mimeType = 'application/vnd.openxmlformats-officedocument.presentationml.presentation' or mimeType = 'application/vnd.google-apps.presentation' or mimeType = 'application/vnd.google-apps.punch')",spreadsheet:"(mimeType = 'application/msexcel' or mimeType = 'application/vnd.google-apps.form' or mimeType = 'application/vnd.google-apps.freebird' or mimeType = 'application/vnd.google-apps.ritz' or mimeType = 'application/vnd.google-apps.spreadsheet' or mimeType = 'application/vnd.ms-excel' or mimeType = 'application/vnd.oasis.opendocument.spreadsheet' or mimeType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')",video:"(mimeType = 'video/3gpp' or mimeType = 'video/avi' or mimeType = 'video/dv' or mimeType = 'video/flv' or mimeType = 'video/mp2p' or mimeType = 'video/mp2t' or mimeType = 'video/mp4' or mimeType = 'video/mpeg' or mimeType = 'video/mpv' or mimeType = 'video/ogg' or mimeType = 'video/quicktime' or mimeType = 'video/x-flv' or mimeType = 'video/x-msvideo' or mimeType = 'video/x-ms-wmv' or mimeType = 'video/x-m4v' or mimeType = 'video/x-ms-asf' or mimeType = 'video/x-matroska' or mimeType = 'video/x-dv' or mimeType = 'video/webm')"},M={document:{fabLabel:cjBasics.lang.i18n("cj_i18n_00607","New document"),label:cjBasics.lang.i18n("cj_i18n_00391","Docs"),newTabUrl:cjgShortcuts.getUrl("299",l.account),icon:{size:32,name:"__mdi:drive_document",color:"#4285f4"}},spreadsheet:{fabLabel:cjBasics.lang.i18n("cj_i18n_00608","New spreadsheet"),label:cjBasics.lang.i18n("cj_i18n_00393","Sheets"),newTabUrl:cjgShortcuts.getUrl("300",l.account),icon:{size:32,name:"__mdi:drive_spreadsheet",color:"#34a853"}},presentation:{fabLabel:cjBasics.lang.i18n("cj_i18n_00609","New presentation"),label:cjBasics.lang.i18n("cj_i18n_00407","Slides"),newTabUrl:cjgShortcuts.getUrl("301",l.account),icon:{size:32,name:"__mdi:drive_presentation",color:"#fbbc05"}},upload:{fabLabel:cjBasics.lang.i18n("cj_i18n_01933","Upload file"),label:cjBasics.lang.i18n("cj_i18n_01934","File upload"),onClick:function(){e.click()},newTabUrl:"__bm_drive_upload",icon:{size:32,name:"__mdi:file_upload"}},folder:{fabLabel:cjBasics.lang.i18n("cj_i18n_01935","New folder"),label:cjBasics.lang.i18n("cj_i18n_01794","Folder"),newTabUrl:"__bm_drive_folder",onClick:function(){var e=cjce.createElement("cjmd-textfield",{label:cjBasics.lang.i18n("cj_i18n_01937","Folder title")}),i=cjBasics.lang.i18n("cj_i18n_01939","Untitled folder");e.cjceValue=i;var a=cjce.createElement("cjmd-dialog",{title:cjBasics.lang.i18n("cj_i18n_01936","Create new folder"),message:cjBasics.lang.i18n("cj_i18n_01938","Please enter a folder title"),confirmLabel:cjBasics.lang.i18n("cj_i18n_00626","Create"),cancelLabel:cjBasics.lang.i18n("cj_i18n_01659","Cancel"),additionalFragment:e,onConfirm:function(){!function(e){var i={name:e,mimeType:"application/vnd.google-apps.folder"};"folder"!==h&&"shareddrive"!==h||(i.parents=[_.id]);e=x+"/drive/v3/files";cjgApis.request(e,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json; charset=UTF-8"}},{account:l.account,requiredScopes:E}).then(J)}(e.cjceValue||i)}});document.body.appendChild(a),setTimeout(function(){a.showModal(),a=null,e.cjceSelect()})},icon:{size:32,name:"__mdi:create_new_folder"}},form:{fabLabel:cjBasics.lang.i18n("cj_i18n_00631","New form"),label:cjBasics.lang.i18n("cj_i18n_00408","Forms"),newTabUrl:cjgShortcuts.getUrl("329",l.account),icon:{size:32,name:"__mdi:drive_form",color:"#673ab7"}},drawing:{label:cjBasics.lang.i18n("cj_i18n_00409","Drawings"),newTabUrl:cjgShortcuts.getUrl("47",l.account),icon:{size:32,name:"__mdi:drive_drawing",color:"#ea4335"}},atari:{label:cjBasics.lang.i18n("cj_i18n_00112","Sites"),newTabUrl:cjgShortcuts.getUrl("406",l.account),icon:{size:32,name:"__mdi:atari_site",color:"#3e50b4"}},map:{label:cjBasics.lang.i18n("cj_i18n_00410","My Maps"),newTabUrl:"https://www.google.com/maps/d/u/"+l.account.authuser+"/drive?state=%7B%22action%22%3A%22create%22%7D",icon:{size:32,name:"__mdi:file_map",color:"#ea4335"}},script:{label:cjBasics.lang.i18n("cj_i18n_00447","Apps Script"),newTabUrl:cjgShortcuts.getUrl("730",l.account),icon:{size:32,name:"__mdi:drive_script",color:"#1a73e8"}},jam:{label:cjBasics.lang.i18n("cj_i18n_00813","Jamboard"),newTabUrl:"https://jamboard.google.com/create?authuser="+l.account.authuser,icon:{size:32,name:"__mdi:cj_jam_drive",color:"#fb8c00"}}},O=["document","spreadsheet","presentation","form","drawing","atari","script","map","jam"].map(function(e){return M[e]}),D={pdf:{icon:{name:"__mdi:drive_pdf",color:"#ea4335"},label:cjBasics.lang.i18n("cj_i18n_00137","PDFs")},document:{icon:{name:"__mdi:drive_document",color:"#4285f4"},label:cjBasics.lang.i18n("cj_i18n_00138","Text documents")},spreadsheet:{icon:{name:"__mdi:drive_spreadsheet",color:"#34a853"},label:cjBasics.lang.i18n("cj_i18n_00139","Spreadsheets")},presentation:{icon:{name:"__mdi:drive_presentation",color:"#fbbc05"},label:cjBasics.lang.i18n("cj_i18n_00140","Presentations")},image:{icon:{name:"__mdi:drive_image",color:"#ea4335"},label:cjBasics.lang.i18n("cj_i18n_00141","Photos & images")},video:{icon:{name:"__mdi:drive_video",color:"#ea4335"},label:cjBasics.lang.i18n("cj_i18n_00142","Videos")}},F={priority:{label:cjBasics.lang.i18n("cj_i18n_06245","Priority"),iconName:"__mdi:priority_outline",newTabUrl:T+"priority"},"my-drive":{label:cjBasics.lang.i18n("cj_i18n_00001","My Drive"),iconName:"__mdi:my_drive",newTabUrl:T+"my-drive"},"shared-with-me":{label:cjBasics.lang.i18n("cj_i18n_00002","Shared with me"),iconName:"__mdi:people",newTabUrl:T+"shared-with-me"},recent:{label:cjBasics.lang.i18n("cj_i18n_00003","Recent"),iconName:"__mdi:schedule",newTabUrl:T+"recent"},starred:{label:cjBasics.lang.i18n("cj_i18n_00004","Starred"),iconName:"__mdi:star_outline",newTabUrl:T+"starred"},trash:{label:cjBasics.lang.i18n("cj_i18n_00005","Bin"),iconName:"__mdi:delete",newTabUrl:T+"trash"},computers:{label:cjBasics.lang.i18n("cj_i18n_01307","Computers"),iconName:"__mdi:devices",external:!0,newTabUrl:T+"computers"},backups:{label:cjBasics.lang.i18n("cj_i18n_01308","Backups"),iconName:"__mdi:mobile_friendly",external:!0,newTabUrl:T+"backups"},quota:{label:cjBasics.lang.i18n("cj_i18n_01833","Storage"),iconName:"__mdi:cloud",newTabUrl:T+"quota"},storage:{label:cjBasics.lang.i18n("cj_i18n_00077","Upgrade storage"),iconName:"__mdi:storage",external:!0,newTabUrl:a+"/"+l.wizPath+"settings/storage"}};function R(e){return"my-drive"===e||"priority"===e||"recent"===e||"starred"===e||"shared-with-me"===e}function J(){var i;L&&(c.cjceSetLoading(!0),i=function(){var e=A[g];if("shared-with-me"===h)return{q:"trashed = false and not 'me' in owners and sharedWithMe",orderBy:"sharedWithMeTime desc"};if("recent"===h)return{q:"(not mimeType = 'application/vnd.google-apps.folder') and trashed = false",orderBy:"recency desc"};if("trash"===h)return{q:"trashed = true and explicitlyTrashed = true",orderBy:"folder,"+e};if("quota"===h)return{q:"(not mimeType in 'application/vnd.google-apps.folder') and trashed = false and 'me' in owners",orderBy:"quotaBytesUsed desc"};if("starred"===h)return{q:"trashed = false and starred = true",orderBy:"folder,"+e};if("my-drive"===h)return{q:"trashed = false and 'root' in parents",orderBy:"folder,"+e};if("priority"===h)return{priority:!0};if("folder"===h)return{q:"trashed = false and '"+_.id+"' in parents",orderBy:"folder,"+e};if("shareddrive"===h)return{q:"trashed = false and '"+_.id+"' in parents",orderBy:"folder,"+e};if("search"!==h)return null;var i=d.value,a=["trashed = false"],n=i;return-1!==i.indexOf("type:")&&(n="",e=i.split("type:")[1],-1!==i.indexOf(" ")&&(n=i.split(" ")[1],e=e.split(" ")[0]),e=I[e],a.push(e)),a.push("fullText contains '"+n+"'"),{q:a.join(" and ")}}(),l.requirePage("doclist").then(function(){var e=cjce.createElement("cjg-doclist",{gAccount:l.account,darkMode:l.darkMode,additionalFragment:!i.priority&&n,listview:!i.priority&&y,shadow:"thinOnScroll",openInNew:l.openTab,onFolderClick:V,onLoadingChange:function(e){c.cjceSetLoading(e)},searching:"search"===h,cachingId:R(h)?"bm_cache_v31__drive__mainviewcache_"+h:null,orderBy:i.orderBy,priority:i.priority,q:i.q});cjce.replaceChild(o,e,r),r=e}))}function G(e,i){var a=F[e];m.hidden="folder"!==e,"search"!==h&&"folder"!==h&&("folder"===e?(b=h,u=_):"search"===e&&(j=h,f=_)),h=e,_=i,s&&(s.cjceSelectedId=e),a?c.cjceSetPageLabel(a.label):"folder"===h?(m.cjceSetPageLabel(""),function t(s){var e=cjBasics.urlParams.attach(U+"files/"+s.id,{fields:"name,id,parents,driveId",prettyPrint:"false",supportsAllDrives:"true",includeItemsFromAllDrives:"true"});cjgApis.request(e,{fetchAs:"json"},{account:l.account,requiredScopes:E}).then(function(e){var i=document.createElement("span"),a=e.name||cjBasics.lang.i18n("cj_i18n_01794","Folder"),n=e.driveId===e.id;n&&(a=z[e.id]||cjBasics.lang.i18n("cj_i18n_01795","Shared drive")),i.textContent=a;var r,c,o=m.querySelector(".bm-p-drive-foldertree");o?(r=document.createTextNode(" > "),i.addEventListener("click",function(){o.firstChild===i?n?G("shareddrive",{id:e.id,label:a}):G("my-drive"):G("folder",s)}),c=o.firstChild,o.insertBefore(r,c),o.insertBefore(i,r)):((o=document.createElement("span")).classList.add("bm-p-drive-foldertree"),o.appendChild(i),m.cjceSetPageLabel(o)),"parents"in e&&t({id:e.parents[0]})})}(_)):"shareddrive"===h&&(s.cjceSelectedId="shareddrive-"+i.id,c.cjceSetPageLabel(i.label));i=-1===C.indexOf(e);v.style.display=i?"none":"",J(),R(e)&&browserStorage.local.setItem("bm_pref__drive__lastid",e)}function V(e){var i=e.folderColorRgb;G("folder",{label:e.name,id:e.id,color:i="#8f8f8f"===i?null:i})}function H(e){var i=d.value;-1!==i.indexOf("type:")&&(i=i.split(" ")[1]),d.value="type:"+e+(i?" "+i:""),c.cjceSetNavigatorCollapseState(!0),"search"===h?J():G("search")}function W(e){e=e,e="folder"!==h&&"shareddrive"!==h?e:((e=new URL(e)).searchParams.set("folder",_.id),e.href);l.openTab(e)}function Z(){i=cjce.createElement("cjmd-sheet",{from:"bottom",triggerElement:p});var e=cjce.createElement("bm-shortcutlist",{onNewTab:function(e){"__bm_drive_upload"===e?M.upload.onClick():"__bm_drive_folder"===e&&M.folder.onClick()},items:L?[M.folder,M.upload]:[]});i.appendChild(e);e=cjce.createElement("cjmd-subheader",{color:!0,label:cjBasics.lang.i18n("cj_i18n_01309","Google apps")});i.appendChild(e);e=cjce.createElement("bm-shortcutlist",{onNewTab:W,items:O});i.appendChild(e);var n=document.createElement("div");function a(e){n.textContent="";var i="NOT_AUTHORIZED"===e,a=Array.isArray(e)&&0<e.length;(i||a)&&(a=cjce.createElement("cjmd-subheader",{color:!0,label:cjBasics.lang.i18n("cj_i18n_01310","More apps")}),n.appendChild(a),i?(i=cjce.createElement("bm-inlinepermission",{description:cjBasics.lang.i18n("cj_i18n_01311","Grant read-only access to your Drive Apps so we can list more apps here"),onClick:function(){cjgApis.auth.requestPermissions(l.account,N)}}),n.appendChild(i)):(e=cjce.createElement("bm-shortcutlist",{onNewTab:W,items:e}),n.appendChild(e)))}i.appendChild(n);var r=null,c=!1;cjgApis.cache.getItem(l.account,"bm_cache_v31__drive__createapps").then(function(e){!c&&e&&(r=JSON.stringify(e),a(e))}),e=cjBasics.urlParams.attach(x+"/drive/v2/apps",{prettyPrint:"false",hl:cjBasics.lang.current,fields:"items(supportsCreate,id,name,createUrl,icons(size,category,iconUrl))"}),cjgApis.request(e,{fetchAs:"json"},{account:l.account,pa:"optional",key:S,requiredScopes:N}).then(function(e){var n=[];return e.items.forEach(function(e){var i,a;e.supportsCreate&&-1===k.indexOf(e.id)&&(a=24*window.devicePixelRatio,e.icons.sort(function(e,i){return e.size<i.size?1:-1}).forEach(function(e){"application"===e.category&&e.size>=a&&(i=e.iconUrl)}),n.push({label:e.name,newTabUrl:e.createUrl,icon:{url:i}}))}),n},function(){return"NOT_AUTHORIZED"}).then(function(e){c=!0;var i=JSON.stringify(e);r&&i===r||(a(e),cjgApis.cache.setItem(l.account,"bm_cache_v31__drive__createapps",e))}),o.appendChild(i)}function Q(e){i||Z(),setTimeout(function(){i.cjceToggleState(!0)}),setTimeout(function(){var e=i.querySelector(".cjmd-item");e&&e.focus()},50)}function Y(r){return n=r,new Promise(function(e,i){var a=new window.FileReader;a.readAsBinaryString(n),a.addEventListener("load",function(){e(a.result)}),a.addEventListener("error",function(){var e=new Error("Read as binary failed");i(e)})}).then(function(e){var i=r.type||"application/octet-stream",a={name:r.name,mimeType:i};"folder"!==h&&"shareddrive"!==h||(a.parents=[_.id]);var n="bmfg_upload_boundary",i=["--"+n,"Content-Type: application/json; charset=UTF-8",'Content-Disposition: form-data; name="metadata"',"",JSON.stringify(a),"--"+n,"Content-Type: "+i,'Content-Disposition: form-data; name="file"',"",e,"--"+n+"--"].join("\n"),e=cjBasics.urlParams.attach(x+"/upload/drive/v3/files",{uploadType:"multipart",prettyPrint:"false",fields:""});return cjgApis.request(e,{method:"POST",body:i,headers:{"Content-Type":'multipart/related; boundary="'+n+'"'}},{account:l.account,requiredScopes:E})},function(){});var n}function K(){p=cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_00090","New file"),isPlaceholder:!0,onClick:Q});var e=cjce.createElement("cjmd-fabgroup",{items:["main","upload","folder","document","spreadsheet","presentation","form"].map(function(e){if("main"===e)return p;var i,a="upload"===e||"folder"===e,n=(i=M[e],cjce.createElement("cjmd-fab",{mini:!0,label:i.fabLabel,color:i.icon.color,fill:!a&&l.darkMode,iconName:i.icon.name,onClick:i.onClick||function(){W(i.newTabUrl)}}));return a&&q.then(function(){L||n.remove()}),n})});o.appendChild(e)}function X(e){e=cjBasics.urlParams.attach(T+"search",{q:e});l.openTab(e)}function $(e){t.textContent="";var i=["priority","my-drive","shared-with-me","recent","starred","trash","quota"].map(function(e){var i=F[e];return i.id=e,i}),a=i.length-1,n=i[a];i[a]=Object.assign({},n),i[a].divider=!0;var r=e.length;if(0<r){i.push({header:!0,color:!0,label:cjBasics.lang.i18n("cj_i18n_01782","Shared drives")});for(var c=0;c<r;c++){var o=e[c];z[o.id]=o.name,i.push({id:"shareddrive-"+o.id,iconName:"__mdi:cjg_blank_drive",label:o.name,sharedDriveId:o.id,newTabUrl:T+"folders/"+o.id,divider:c===r-1})}}["computers","backups","storage"].forEach(function(e){i.push(F[e])}),s=cjce.createElement("bm-navlist",{compact:!0,isSelector:!0,selectedId:h,items:i,onChange:function(e,i){L&&(i.sharedDriveId?G("shareddrive",{label:i.label,id:i.sharedDriveId}):G(e))},onNewTab:function(e,i){l.openTab(i.newTabUrl)}}),t.appendChild(s)}function ee(){if(!l.account.validSession)return $([]),0;var e,i=!1,a="";cjgApis.cache.getItem(l.account,"bm_cache_v31__drive__shareddrives").then(function(e){i||(e=e||[],a=JSON.stringify(e),$(e))}),e=cjBasics.urlParams.attach(U+"drives",{prettyPrint:"false",fields:"drives(id,name)",pageSize:"100"}),cjgApis.request(e,{fetchAs:"json"},{account:l.account,requiredScopes:E}).then(function(e){e=e.drives;return cjgApis.cache.setItem(l.account,"bm_cache_v31__drive__shareddrives",e),e},function(){return[]}).then(function(e){i=!0,e=e||[],JSON.stringify(e)!==a&&$(e)})}(B=document.createElement("input")).type="file",B.multiple=!0,B.style.display="none",B.addEventListener("change",function(){c.cjceSetLoading(!0);for(var e=[],i=0;i<B.files.length;i++)e.push(Y(B.files[i]));Promise.all(e).catch(function(){}).then(function(){c.cjceSetLoading(!1),J()})}),e=B,o.appendChild(e),c=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,serviceIcon:"drive",bmApis:l,onNewTab:w,pageLabel:F[h].label,serviceLabel:cjBasics.lang.i18n("cj_i18n_00390","Drive"),searchbox:{onClear:function(){G(j,f)},onSubmit:function(e){if(!L)return X(e);"search"!==h?G("search"):J()},onMetaSubmit:X}}),t=c.cjceDrawerEl,ee(),(d=c.cjceSearchboxEl).classList.add("bm-p-drive-searchbox"),o.appendChild(c),l.setOnPageDisplayHandler(function(){d.select()}),K(),Promise.all([browserStorage.local.getItem("bm_pref__drive__lastid"),browserStorage.sync.getItem("bm_pref__drive__thumbs"),browserStorage.sync.getItem("bm_pref__drive__order")]).then(function(e){var i=e[0],a=e[1];e=e[2],g=e in P?e:"modifiedTime desc"===e?"lastModified":"modifiedByMeTime desc"===e?"lastModifiedByMe":"viewedByMeTime desc"===e?"lastOpenedByMe":"name",h=i||"my-drive",c.cjceSetPageLabel(F[h].label),y=!a,n=function(){var e=cjce.createElement("cjmd-appbar");function i(e){y=!y,a.hidden=y,n.hidden=!y,browserStorage.sync.setItem("bm_pref__drive__thumbs",!y),J()}e.classList.add("bm-p-drive-filterbar"),v=cjce.createElement("cjmd-iconbuttonmenu",{label:cjBasics.lang.i18n("cj_i18n_00096","Order by"),iconName:"__mdi:cj_sort_by_alpha",items:P,selectedId:g,isSelector:!0,onChange:function(e){g=e,J(),browserStorage.sync.setItem("bm_pref__drive__order",e)}}),e.appendChild(v);var a=cjce.createElement("cjmd-iconbutton",{label:cjBasics.lang.i18n("cj_i18n_00106","Change view"),iconName:"__mdi:view_list",onClick:i});a.hidden=y,e.appendChild(a);var n=cjce.createElement("cjmd-iconbutton",{label:cjBasics.lang.i18n("cj_i18n_00106","Change view"),iconName:"__mdi:view_module",onClick:i});return n.hidden=!y,e.appendChild(n),e}(),(m=cjce.createElement("bm-ogb",{displayBack:!0,floating:!0,aboveTopDrawer:!0,bmApis:l,onNewTab:w,serviceLabel:cjBasics.lang.i18n("cj_i18n_00390","Drive"),pageLabel:F["my-drive"].label,onBack:function(){G(b,u)}})).hidden=!0,o.appendChild(m);i=cjce.createElement("cjmd-menu",{variant:"searchbox",items:D,onClick:H});i.classList.add("bm-p-drive-searchmenu");a=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:arrow_drop_down"});cjce.applyTemplate(a,"basic-togglemenuhandler",{menuElement:i}),a.classList.add("bm-p-drive-searchmenubutton"),d.appendChild(a),d.appendChild(i),J(),s.cjceSelectedId=h,window.requestIdleCallback&&window.requestIdleCallback(Z)}),q.then(function(e){var i,a,n;L||(cjgApis.cache.remove(l.account,["bm_cache_v31__drive__shareddrives","bm_cache_v31__drive__createapps","bm_cache_v31__drive__mainviewcache_shared-with-me","bm_cache_v31__drive__mainviewcache_recent","bm_cache_v31__drive__mainviewcache_trash","bm_cache_v31__drive__mainviewcache_starred","bm_cache_v31__drive__mainviewcache_my-drive","bm_cache_v31__drive__mainviewcache_priority"]),a=cjce.createElement("bm-ogb",{serviceIcon:"drive",bmApis:l,onNewTab:w,pageLabel:cjBasics.lang.i18n("cj_i18n_01167","Links"),serviceLabel:cjBasics.lang.i18n("cj_i18n_00390","Drive"),searchbox:{onSubmit:X,submitInNewTab:!0}}),cjce.replaceChild(o,a,c),(d=a.cjceSearchboxEl).focus(),i=cjce.createElement("cjmd-container",{shadow:"thinOnScroll",fabPadding:!0,scrollable:!0}),a=cjce.createElement("bm-inlinepermission",{description:cjBasics.lang.i18n("cj_i18n_01313","Grant access to your Google Drive Account so we can list your files and folders here"),divider:!0,onClick:function(){cjgApis.auth.requestPermissions(l.account,e.cjg_missing_scopes)}}),i.appendChild(a),a=Object.keys(F).map(function(e){e=F[e];return e.external=!0,e}),(n=(s=cjce.createElement("bm-navlist",{compact:!0,items:a,onNewTab:function(e,i){l.openTab(i.newTabUrl)}})).firstChild).hidden=!0,cjgApis.info.getUserDomain(l.account).then(function(e){e&&(n.hidden=!1)}),i.appendChild(s),cjce.replaceChild(o,i,r))})});