"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cjce.registerTemplate("bm-p-portal",function(p,m){var u,g,v="object"===("undefined"==typeof chrome?"undefined":_typeof(chrome))&&chrome&&chrome.runtime&&chrome||"object"===("undefined"==typeof browser?"undefined":_typeof(browser))&&browser||{},f=["applauncher","customize","notifications","extensionsettings","accountchooser","removedialog"],b="",j="search",_="search",h=!1;function L(e){if(e.shortcutId){var a=cjgShortcuts.getUrl(e.shortcutId,m.account);if(a)return void m.openTab(a)}e.url&&m.openTab(e.url)}m.darkMode&&p.style.setProperty("--background-color","#2d2d2d");var C={},E={};function c(a,e){var n=m.servicesDatabase[a],t=n.iconName||"placeholder";m.darkMode&&"googleg"===t&&(t="search");var c,i=cjce.createElement("cjmd-item",{icon:{serviceName:t},label:n.label});return i.classList.add("bm-p-portal-pageitem"),i.dataset.id=a,i.tabIndex=0,i.style.color=(t=n.color)?!0===t?m.darkMode?"#669df6":"#1a73e8":t:m.darkMode?"rgba(255, 255, 255, 0.8)":"#212121",e?(i.draggable=!0,(c=cjce.createElement("cjmd-icon",{name:"__mdi:drag_indicator",size:20})).classList.add("bm-p-portal-pageitem__dragicon"),i.appendChild(c),(c=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:delete",label:cjBasics.lang.i18n("cj_i18n_01164","Remove from menu"),onClick:function(e){m.userServices.remove(a),i.remove(),b=b.replace("_"+a+"_","_"),e.stopPropagation()}})).classList.add("bm-p-portal-pageitem__remove"),i.appendChild(c)):(n.shortcutId||n.url)&&((c=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:open_in_new",label:cjBasics.lang.i18n("cj_i18n_00084","Open service in new tab"),onClick:function(e){L(n),e.stopPropagation()}})).classList.add("bm-p-portal-pageitem__open-in-new"),i.appendChild(c)),i}function y(e){e===j?m.pageManager.navigate(_):m.pageManager.navigate(e)}function k(){var n=(-1!==window.location.search.indexOf("debug")||!m.account.pageId)&&h,t=document.createDocumentFragment();(u||[]).forEach(function(e){var a;m.servicesDatabase[e]&&(a=c(e,n),E[e]=a,t.appendChild(a))});var e=E[j];e&&e.classList.add("cjmd-item--selected"),g.textContent="",g.appendChild(t),e&&w(e)}function w(e){var a=g.scrollTop,n=e.offsetTop,e=n-60;e<a?g.scrollTop=e:a<(n=n-g.offsetHeight-4)&&(g.scrollTop=n)}function M(e){var a=u.indexOf(j),a=(a=u[a+(e?-1:1)])||(e?u[u.length-1]:u[0]);m.pageManager.navigate(a)}function S(e){"removedialog"===j&&m.pageManager.navigate("customize")}function x(e){e.preventDefault()}function z(e){e.preventDefault();var a=e.dataTransfer.getData("serviceId"),n=e.target,t=n,t=(t=24<e.offsetY&&n.nextSibling?n.nextSibling:t).dataset.id,t=u.indexOf(t);n===g||-1===t?m.userServices.add(a):(-1!==(n=u.indexOf(a))&&u.splice(n,1),u.splice(t,0,a),m.userServices.set(u)),S()}function B(e){m.pageManager.navigate("removedialog"),e.dataTransfer.setData("serviceId",e.target.dataset.id)}!function(){m.darkMode&&p.classList.add("cjmd--dark");var a,e,n,t=(t=cjce.createElement("cjmd-appbar"),(n=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:apps",label:cjBasics.lang.i18n("cj_i18n_00216","Apps"),onClick:function(){y("applauncher")}})).classList.add("bm-p-portal-pageicon"),C.applauncher=n,t.appendChild(n),(n=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),onClick:function(){y("extensionsettings")}})).classList.add("bm-p-portal-pageicon"),C.extensionsettings=n,t.appendChild(n),m.account.validSession?((e=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:notifications",label:cjBasics.lang.i18n("cj_i18n_00296","Notifications"),onClick:function(e){y("notifications")}})).classList.add("bm-p-portal-pageicon"),C.notifications=e,t.insertBefore(e,n),e=cjgApis.session.account.displayName,cjgApis.session.account.pageId&&(e+="\n"+cjBasics.lang.i18n("cj_i18n_00363","Brand account")),cjgApis.session.account.displayEmail&&(e+="\n"+cjgApis.session.account.displayEmail),a=cjce.createElement("cjmd-iconbutton",{label:e,icon:{size:32,circle:!0,url:cjgApis.session.account.photoUrl+"?sz="+Math.ceil(32*window.devicePixelRatio),backupUrl:"/images/avatar.svg"},onClick:function(){y("accountchooser")}}),(C.accountchooser=a).classList.add("bm-p-portal-pageicon"),t.appendChild(a),cjgApis.info.getIsOne(m.account).then(function(e){e&&a.classList.add("bm-p-portal-accountbutton--one")})):((e=cjce.createElement("cjmd-button",{label:cjBasics.lang.i18n("cj_i18n_01544","Sign in"),fill:!0,color:!0,onClick:function(){cjgApis.account.signin(m.account)}})).classList.add("bm-p-portal-signin"),t.appendChild(e)),t);p.appendChild(t),(g=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"})).setAttribute("role","navigation"),g.addEventListener("click",function(e){var a=e.target.dataset.id;a&&(cjBasics.events.hasMeta(e)?L(m.servicesDatabase[a]):m.pageManager.navigate(a))}),g.addEventListener("mousedown",function(e){e=e.target.dataset.id;e&&m.loadPage(e)}),g.addEventListener("auxclick",function(e){var a;1!==e.button||(a=e.target.dataset.id)&&(L(m.servicesDatabase[a]),e.preventDefault())}),g.addEventListener("keydown",function(e){if(!cjBasics.events.hasModifier(e)){var a=e.key,n=document.activeElement;if("ArrowUp"===a)(n.previousSibling||n.parentNode.lastChild).focus();else if("ArrowDown"===a)(n.nextSibling||n.parentNode.firstChild).focus();else{if("Enter"!==a&&" "!==a)return;n.click()}e.preventDefault()}}),m.userServices.onChange(function(e){var a="_"+e.join("_")+"_";b!==a&&(u=e,b=a,k())}),m.pageManager.onChange(function(e){var a,n,t;e!==j&&((a=C[n=j])?a.classList.remove("cjmd-iconbutton--active"):(n=E[n])&&n.classList.remove("cjmd-item--selected"),-1===f.indexOf(e)&&(_=e),(n="customize"===(j=e)||"removedialog"===e)!==h?(h=n,k(),g.classList.toggle("bm-p-portal-pagelist--customize",h),t=h,r&&(c.classList.toggle("bm-p-portal-customize--finish",t),o.hidden=t,s.hidden=!t,i||(r.textContent=t?l:d),t?(window.addEventListener("dragend",S),g.addEventListener("dragover",x),g.addEventListener("drop",z),g.addEventListener("dragstart",B)):(window.removeEventListener("dragend",S),g.removeEventListener("dragover",x),g.removeEventListener("drop",z),g.removeEventListener("dragstart",B)))):(t=C[e])?t.classList.add("cjmd-iconbutton--active"):(e=E[e])&&(e.classList.add("cjmd-item--selected"),w(e)))}),p.appendChild(g);var c=document.createElement("div");c.className="bm-p-portal-page bm-p-portal-customize";var i=Boolean(m.account.pageId);c.dataset.id=i?"accountchooser":"customize";var o=cjce.createElement("cjmd-icon",{name:i?"__mdi:account_circle":"__mdi:edit",color:m.darkMode?null:"#5f6368"});o.classList.add("bm-p-portal-customize__icon"),c.appendChild(o);var s=cjce.createElement("cjmd-icon",{name:"__mdi:done",color:m.darkMode?null:"#1a73e8"});s.hidden=!0,s.classList.add("bm-p-portal-customize__icon"),c.appendChild(s);var r=document.createElement("div"),d=cjBasics.lang.i18n("cj_i18n_01713","Customize"),t=cjBasics.lang.i18n("cj_i18n_01543","Switch account"),l=cjBasics.lang.i18n("cj_i18n_01715","Finish");r.textContent=i?t:d,r.className="bm-p-portal-customize__label",c.appendChild(r),c.addEventListener("click",function(){var e;i?m.pageManager.navigate("accountchooser"):(e=h?_:"customize",m.pageManager.navigate(e))}),p.appendChild(c),"object"===_typeof(v.commands)&&v.commands.onCommand&&v.commands.onCommand.addListener&&v.commands.onCommand.addListener(function(e){"portal-next-page"===e?M(!1):"portal-previous-page"===e&&M(!0)})}()});